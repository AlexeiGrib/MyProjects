# Описание проекта "Predict TripAdvisor Rating".

В рамках данного проекта требовалось предсказать рейтинг ресторана в TripAdvisor. Работу над проектом проводили по следующим этапам:

1. Импорт библиотек, подготовка функций, чтение и первичный анализ данных.

2. Предобработка данных.

3. Исследовательский анализ данных.

4. Создание новых признаков.

5. Препроцессинг.

6. Обучение и тестирование модели.

Метрикой качества модели была средняя квадратическая ошибка (МАЕ).

Отметим некоторые выводы по каждому этапу работы.

## Вывод по этапу 1.

На данном этапе мы испортировали необходимые для работы библиотеки, подготовили несколько функций для анализа и обработки данных, а также провели мини-EDA набора данных.

## Вывод по этапу 2.

На данном этапе мы осуществили предварительную обработку данных по следующим направлениям:

1. В признаке cuisine_style пропущенные значения заменили на наиболее часто встречающуюся в ресторанах кухню - Vegetarian Friendly.

2. В признаке price_range пропущенные значения заменили на наиболее часто встречающийся ценовой сегмент ресторана в наборе данных, а также закодировали категориальный признак в цифровое представление.

3. В признаке number_of_reviews пропущенные значения заменили на 0.

## Вывод по этапу 3.

На данном этапе мы провели исследовательский анализ данных некоторых имеющихся признаков.

Удалось выяснить, что:

1. В наборе данных встрачаются как одиночные рестораны, так и сети ресторанов.

2. Распределение признака Ranking сильно зависит от размера города и количества в нём ресторанов.

3. В разных городах имеется разное количество уникальных ресторанов.

4. В наборе данных больше всего информации об отзывах с оценкой от 3 и выше, а также с оценкой 0.

## Вывод по этапу 4.

На данном этапе мы создали новые признаки на основе уже имеющихся в наборе данных:

1. На основе признака "cuisine_style" мы создали признак, показывающий количество кухонь, представленных в ресторане, а также признак наличия в ресторане самой популярной кухни.

2. На основе признака "restaurant_id" мы создали признак, показывающий, чем является ресторан - уникальные заведением или сетью ресторанов.

3. На основе признака "reviews" мы создали два промежуточных параметра - дата первого и второго доступных ревью - и на их основе создали ряд новых признаков: разницу в днях между ревью, а также признаки-даты из этих двух дат: год, месяц, день и день недели первого и второго ревью.

4. С помощью признаков "city" и "restaurant_id" мы создали признак, описывающий количество уникальных ресторанов в каждом городе, а также дамми-переменные на основе признака "city", при этом для избежания эффекта мультиколлиреарности мы построили n-1 дамми-признак, где n - количество уникальных городов в наборе данных.

5. На основе признака "ranking" была создана переменная, разбивающая признак "ranking" на 10 групп по мере возрастания значения признака. Кроме того, признаки "ranking" и "number_of_reviews" были нормированы с помощью z-преобразования.

6. На последнем этапе мы избавились от ненужных для моделирования признаков, а также проверили признаки с помощью корреляционной матрицы на предмет сильной скоррелированности признаков с целеовой переменной и мультиколлинеарности.

## Вывод по этапу 5.

На данном этапе мы собрали весь пайплайн предобработки данных и создания новых признаков в единую функцию. Это позволит быстро готовить аналогичные данные к повторному моделированию.

## Вывод по этапу 6.

На данном этапе мы обучили модель и протестировали её работу с помощью метрики MAE: удалось достигнуть значения метрики в 0.2076 на валидационной выборке.
